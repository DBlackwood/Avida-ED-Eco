
                        <div id='sugarAccordion'></div>

<script type="text/javascript" >
  // The following should be done once and only once, probably in onload or something like that.
  String.prototype.replaceAll = function(search, replacement) {
    var target = this;
    return target.split(search).join(replacement);
  };


  // Regular code from this point
  
  var ordered_sugars = `
    not
nan
and
orn
oro
ant
nor
xor
equ

notose
nanose
andose
orose
orrose
antose
norose
xorose
equose

`;

  var sugarAccordionElement = document.getElementByID('sugarAccordion');

  var newhtml = "";

  var sugarReplacements = [
     ['not', 'Not', 'notose' ], // 1
     ['nan', 'Nan', 'nanose' ], // 2
     ['and', 'And', 'andose' ], // 3
     ['orn', 'Orn', 'ornose' ], // 4
     ['oro', 'Oro', 'orose' ], // 5
     ['ant', 'Ant', 'antose' ], // 6
     ['nor', 'Nor', 'norose' ], // 7
     ['xor', 'Xor', 'xorose' ], // 8
     ['equ', 'Equ', 'equose' ], // 9
     ];


  var template = `

                          <!-- Sugar of interest: $sug1$ ----------------------------------- -->
                          <details id='$sug1$Section' class='sugarAccordionSection'>
                            <summary class='sugarSummary'>
                              <div id='$sug1$Title' class='sugarTitle'>$sug3$</div>&nbsp;
                              <select  id='$sug1$Geometry' class='globalLocal' onchange='av.sgr.geometryChange(this);'>
                                <option value='Global' selected>Global</option>
                                <option value='Local'>Local</option>
                              </select>&nbsp;&nbsp;&nbsp;
                              <select  id='$sug1$0SupplyType' class='sugarSupplyType' onchange='av.sgr.supplyChange(this)'>
                                <option id='$sug1$0none' value='None'>None</option>
                                <option id='$sug1$0Infinite' value='Infinite' selected>Infinite</option>
                                <option id='$sug1$0Finite' class='globalFinite' value='Finite'>Finite</option>
                                <option id='$sug1$0Equilibrium' class='globalEquilibrium' value='Equilibrium'>Equilibrium</option>
                                <option id='$sug1$0All' class='globalAll' value='All'>All debug only</option>
                              </select>&nbsp;&nbsp;&nbsp;
                              <select  id='$sug1$0dishRegion' class='dishRegion' onchange='av.sgr.dishRegionChange(this)'>
                                <option id='$sug1$0WholeDish' value='WholeDish selected'>Whole Dish</option>
                                <option id='$sug1$0HalvesLeftRight' class='HalfLftRit' value='HalvesLeftRight'>Halves Left/Right</option>
                                <option id='$sug1$0TopLeftRight' class='TopLftRit' value='ThirdsTopLeftRight'>Top/Bottom(L/R)</option>
                                <option id='$sug1$0Quarters' class='Quarters' value='Quarters'>Quarters</option>
                              </select>&nbsp;&nbsp;&nbsp;
                              <div id='$sug1$0initialDiv' class='sugarSummaryDiv'>
                                <label><input id='$sug1$0initialInput' class='sugInitialInput' type='text' onchange='av.sgr.initialChange(this);'/>
                                &nbsp;Initial amount per cell&nbsp;&nbsp;</label>
                              </div>
                            </summary>

                            <div id='$sug1$Details' class='sugarDetailSection'>
			 `; // end template

  // This part of the template is iterated 4 times to populate numbers
  var numberReplace = "1";
  var template_2 = `
                              
                              <div id='$sug1$$num$subSection' class='sugarDishSubsection'>
                                <div id='$sug1$$num$Title' class='grid-sugarDetail-item subSectionTitle'>Whole Dish</div>
                                <div id='$sug1$$num$supplyTypeSelectHolder' class='grid-sugarDetail-item typeInput'>
                                  <select  id='$sug1$$num$SupplyType' class='sugarSupplyType' onchange='av.sgr.supplyChange(this);'>
                                    <option id='$sug1$$num$none' value='None'>None</option>
                                    <option id='$sug1$$num$Infinite' value='Infinite' selected>Infinite</option>
                                    <option id='$sug1$$num$Finite' class='localFinite' value='Finite'>Finite</option>
                                    <option id='$sug1$$num$Equilibrium' class='localEquilibrium' value='Equilibrium'>Equilibrium</option>
                                    <option id='$sug1$$num$All' class='localAll' value='All'>All debug only</option>
                                  </select>&nbsp;&nbsp;&nbsp;
                                </div>
                                <div id='$sug1$$num$periodCheckbox' class='grid-sugarDetail-item periodCheckDiv' onchange='av.sgr.eachSugarCheckBoxChange(this);'>
                                  <label><input id='$sug1$$num$periodCheck' type='checkbox'>Periodic&nbsp;&nbsp;</label>
                                </div>
                                <div id='$sug1$$num$$num$gradientCheckbox' class='grid-sugarDetail-item gradientCheckDiv' onchange='av.sgr.eachSugarCheckBoxChange(this);'>
                                  <label><input id='$sug1$$num$gradientCheck' type='checkbox'>Gradient&nbsp;&nbsp;</label>
                                </div>
                                <div id='$sug1$$num$diffuseCheckbox' class='grid-sugarDetail-item diffuseCheckDiv' onchange='av.sgr.eachSugarCheckBoxChange(this);'>
                                  <label><input id='$sug1$$num$diffuseCheck' type='checkbox'>Diffusion&nbsp;&nbsp;</label>
                                </div>
                                <div id='$sug1$$num$hiSideSelectHolder' class='grid-sugarDetail-item sideInput'>
                                  <label><select  id='$sug1$$num$sideSelect'>
                                    <option value='left' selected>Left</option>
                                    <option value='right'>Right</option>
                                    <option value='top'>Top</option>
                                    <option value='bottom'>Bottom</option>
                                    <option value='center'>Center</option>
                                    <option value='edge'>Edge</option>
                                  </select>
                                    <span id='$sug1$$num$sideText'>side text to describe what side means</span></label>
                                </div>
                                <div id='$sug1$$num$periodTime' class='grid-sugarDetail-item periodTime'>
                                  <label><input id='$sug1$$num$periodInput'  class='sugPeriodInput' type='text' onchange='av.sgr.periodChange(this);'/> Period (updates)</label>
                                </div>
                                <div id='$sug1$$num$sideHiText' class='grid-sugarDetail-item sideTitleHi'>High Side</div>
                                <div id='$sug1$$num$sideLoText' class='grid-sugarDetail-item sideTitleLo'>Low Side</div>
                                <div id='$sug1$$num$Blank' class='grid-sugarDetail-item sgrBlank'>&nbsp;&nbsp;&nbsp;&nbsp;</div>  

                                <div id='$sug1$$num$initialHiDiv' class='grid-sugarDetail-item initialHi'>
                                  <label><input id='$sug1$$num$initialHiInput' class='sugInitialHiInput' type='text' onchange='av.sgr.initialChange(this);'/>&nbsp;
                                    <span id='$sug1$$num$initialHiText'>High side initial amount per cell </span></label>
                                </div>
                                <div id='$sug1$$num$initialLoDiv' class='grid-sugarDetail-item initialLo'>
                                  <label><input id='$sug1$$num$initialHiInput' class='sugInitialLoInput' type='text' onchange='av.sgr.initialChange(this);'/>&nbsp;
                                    <span id='$sug1$$num$initialLoText'>Low side initial amount per cell</span></label>
                                </div>
                                <div id='$sug1$$num$inflowHiDiv' class='grid-sugarDetail-item inflowHi'>
                                  <label><input id='$sug1$$num$inflowHiInput' class='sugInflowHiInput' type='text' onchange='av.sgr.inflowChange(this);'/>&nbsp;
                                    <span id='$sug1$$num$inflowHiText' class='sugOutflowLabel'>Inflow amount per cell</span></label>
                                </div>
                                <div id='$sug1$$num$inflowLoDiv' class='grid-sugarDetail-item inflowLo'>
                                  <label><input id='$sug1$$num$inflowLoInput' class='sugInflowLoInput' type='text' onchange='av.sgr.inflowChange(this);'/>&nbsp;
                                  <span id='$sug1$$num$inflowLoText' class='sugOutflowLabel'>Inflow amount per cell on low side</span></label>
                                </div>
                                <div id='$sug1$$num$outflowHiDiv' class='grid-sugarDetail-item outflowHi'>
                                  <label><input id='$sug1$$num$outflowHiInput' class='sugOutflowHiInput' type='text' onchange='av.sgr.outflowChange(this);'/>&nbsp;
                                  <span id='$sug1$$num$outflowHiText' class='sugOutflowLabel'>Outflow fraction per cell.</span></label>
                                </div>
                                <div id='$sug1$$num$outflowLoDiv' class='grid-sugarDetail-item outflowLo'>
                                  <label><input id='$sug1$$num$outflowLoInput' class='sugOutflowLoInput' type='text' onchange='av.sgr.outflowChange(this);'/>&nbsp;
                                    <span id='$sug1$$num$outflowLoText' class='sugOutflowLabel'>Outflow fraction per cell on low side.</span></label>
                                </div>
                                <div id='$sug1$$num$equalHiDiv' class='grid-sugarDetail-item equalHi'>
                                  <span id='$sug1$$num$equalHiValue'></span>
                                  <span id='$sug1$$num$equalHiText'> = equilibrium when no resource has been consumed</span>
                                </div>
                                <div id='$sug1$$num$equalLoDiv' class='grid-sugarDetail-item equalLo'>
                                  <span id='$sug1$$num$equalLoValue'></span>
                                  <span id='$sug1$$num$equalLoText'> = equilibrium if not consumed</span>
                                </div>
                              </div><span id='$sug1$$num$SectionEnd' class='endsugarDishSubsection'> </span>
			      `; // end of template_2 for numeric iteration

  var template_3 = `
			      </div><span id='$sug1$DetailsEnd' class='end_sugarDetailSection_grid_container'></span>
                          </details>
                          
  `; // End of template_3 string

  newhtml = ""; // Clear the string

  for (const sugarlist of sugarReplacements){
    var sug1 = sugarlist[0];
    var sug2 = sugarlist[1];
    var sug3 = sugarlist[2];

    var sug1ReplacePattern = '$sug1$';
    var sug2ReplacePattern = '$sug2$';
    var sug3ReplacePattern = '$sug3$';

    var numReplacePattern = '$num$';

    // First part, globals for this sugar
    var newstr = template;
    newstr = newstr.replaceAll(sug1ReplacePattern, sug1);
    newstr = newstr.replaceAll(sug2ReplacePattern, sug2);
    newstr = newstr.replaceAll(sug3ReplacePattern, sug3);
    
    newhtml.append(newstr);

    // Now add local sections 1 2 3 4
    for (var ii=0; ii < 4; ii++){
      var sugnum = ii + 1;

      newstr = template_2;
      newstr = newstr.replaceAll(sug1ReplacePattern, sug1);
      newstr = newstr.replaceAll(sug2ReplacePattern, sug2);
      newstr = newstr.replaceAll(sug3ReplacePattern, sug3);
      newstr = newstr.replaceAll(numReplacePattern, sugnum);

      newhtml.append(newstr);
    }

    // Finish up with closing the section for this sugar
    newstr = template_3;
    newstr = newstr.replaceAll(sug1ReplacePattern, sug1);
    newstr = newstr.replaceAll(sug2ReplacePattern, sug2);
    newstr = newstr.replaceAll(sug3ReplacePattern, sug3);
    
    newhtml.append(newstr);
  };

  // Now all nine tasks are set up in newhtml.
  // Replace the holding div's innerHTML with that.
  sugarAccordionElement.innerHTML = newhtml;

  // Done.

</script>


<script>

  // Multiline strings supported with backtick as quote    //not needed for the above code to work
  var template_orig = `
                          <!-- Sugar of interest: $sug1$ ----------------------------------- -->
                          <details id='notSection' class='sugarAccordionSection'>
                            <summary class='sugarSummary'>
                              <div id='notTitle' class='sugarTitle'>Notose</div>&nbsp;
                              <select  id='notGeometry' class='globalLocal' onchange='av.sgr.geometryChange(this);'>
                                <option value='Global' selected>Global</option>
                                <option value='Local'>Local</option>
                              </select>&nbsp;&nbsp;&nbsp;
                              <select  id='not0SupplyType' class='sugarSupplyType' onchange='av.sgr.supplyChange(this)'>
                                <option id='not0none' value='None'>None</option>
                                <option id='not0Infinite' value='Infinite' selected>Infinite</option>
                                <option id='not0Finite' class='globalFinite' value='Finite'>Finite</option>
                                <option id='not0Equilibrium' class='globalEquilibrium' value='Equilibrium'>Equilibrium</option>
                                <option id='not0All' class='globalAll' value='All'>All debug only</option>
                              </select>&nbsp;&nbsp;&nbsp;
                              <select  id='not0dishRegion' class='dishRegion' onchange='av.sgr.dishRegionChange(this)'>
                                <option id='not0WholeDish' value='WholeDish selected'>Whole Dish</option>
                                <option id='not0HalvesLeftRight' class='HalfLftRit' value='HalvesLeftRight'>Halves Left/Right</option>
                                <option id='not0TopLeftRight' class='TopLftRit' value='ThirdsTopLeftRight'>Top/Bottom(L/R)</option>
                                <option id='not0Quarters' class='Quarters' value='Quarters'>Quarters</option>
                              </select>&nbsp;&nbsp;&nbsp;
                              <div id='not0initialDiv' class='sugarSummaryDiv'>
                                <label><input id='not0initialInput' class='sugInitialInput' type='text' onchange='av.sgr.initialChange(this);'/>
                                &nbsp;Initial amount per cell&nbsp;&nbsp;</label>
                              </div>
                            </summary>

                            <div id='notDetails' class='sugarDetailSection'>
                              
                              <div id='not1subSection' class='sugarDishSubsection'>
                                <div id='not1Title' class='grid-sugarDetail-item subSectionTitle'>Whole Dish</div>
                                <div id='not1supplyTypeSelectHolder' class='grid-sugarDetail-item typeInput'>
                                  <select  id='not1SupplyType' class='sugarSupplyType' onchange='av.sgr.supplyChange(this);'>
                                    <option id='not1none' value='None'>None</option>
                                    <option id='not1Infinite' value='Infinite' selected>Infinite</option>
                                    <option id='not1Finite' class='localFinite' value='Finite'>Finite</option>
                                    <option id='not1Equilibrium' class='localEquilibrium' value='Equilibrium'>Equilibrium</option>
                                    <option id='not1All' class='localAll' value='All'>All debug only</option>
                                  </select>&nbsp;&nbsp;&nbsp;
                                </div>
                                <div id='not1periodCheckbox' class='grid-sugarDetail-item periodCheckDiv' onchange='av.sgr.eachSugarCheckBoxChange(this);'>
                                  <label><input id='not1periodCheck' type='checkbox'>Periodic&nbsp;&nbsp;</label>
                                </div>
                                <div id='not1gradientCheckbox' class='grid-sugarDetail-item gradientCheckDiv' onchange='av.sgr.eachSugarCheckBoxChange(this);'>
                                  <label><input id='not1gradientCheck' type='checkbox'>Gradient&nbsp;&nbsp;</label>
                                </div>
                                <div id='not1diffuseCheckbox' class='grid-sugarDetail-item diffuseCheckDiv' onchange='av.sgr.eachSugarCheckBoxChange(this);'>
                                  <label><input id='not1diffuseCheck' type='checkbox'>Diffusion&nbsp;&nbsp;</label>
                                </div>
                                <div id='not1hiSideSelectHolder' class='grid-sugarDetail-item sideInput'>
                                  <label><select  id='not1sideSelect'>
                                    <option value='left' selected>Left</option>
                                    <option value='right'>Right</option>
                                    <option value='top'>Top</option>
                                    <option value='bottom'>Bottom</option>
                                    <option value='center'>Center</option>
                                    <option value='edge'>Edge</option>
                                  </select>
                                    <span id='not1sideText'>side text to describe what side means</span></label>
                                </div>
                                <div id='not1periodTime' class='grid-sugarDetail-item periodTime'>
                                  <label><input id='not0periodInput'  class='sugPeriodInput' type='text' onchange='av.sgr.periodChange(this);'/> Period (updates)</label>
                                </div>
                                <div id='not1sideHiText' class='grid-sugarDetail-item sideTitleHi'>High Side</div>
                                <div id='not1sideLoText' class='grid-sugarDetail-item sideTitleLo'>Low Side</div>
                                <div id='not1Blank' class='grid-sugarDetail-item sgrBlank'>&nbsp;&nbsp;&nbsp;&nbsp;</div>  

                                <div id='not1initialHiDiv' class='grid-sugarDetail-item initialHi'>
                                  <label><input id='not1initialHiInput' class='sugInitialHiInput' type='text' onchange='av.sgr.initialChange(this);'/>&nbsp;
                                    <span id='not1initialHiText'>High side initial amount per cell </span></label>
                                </div>
                                <div id='not1initialLoDiv' class='grid-sugarDetail-item initialLo'>
                                  <label><input id='not1initialHiInput' class='sugInitialLoInput' type='text' onchange='av.sgr.initialChange(this);'/>&nbsp;
                                    <span id='not1initialLoText'>Low side initial amount per cell</span></label>
                                </div>
                                <div id='not1inflowHiDiv' class='grid-sugarDetail-item inflowHi'>
                                  <label><input id='not1inflowHiInput' class='sugInflowHiInput' type='text' onchange='av.sgr.inflowChange(this);'/>&nbsp;
                                    <span id='not1inflowHiText' class='sugOutflowLabel'>Inflow amount per cell</span></label>
                                </div>
                                <div id='not1inflowLoDiv' class='grid-sugarDetail-item inflowLo'>
                                  <label><input id='not1inflowLoInput' class='sugInflowLoInput' type='text' onchange='av.sgr.inflowChange(this);'/>&nbsp;
                                  <span id='not1inflowLoText' class='sugOutflowLabel'>Inflow amount per cell on low side</span></label>
                                </div>
                                <div id='not1outflowHiDiv' class='grid-sugarDetail-item outflowHi'>
                                  <label><input id='not1outflowHiInput' class='sugOutflowHiInput' type='text' onchange='av.sgr.outflowChange(this);'/>&nbsp;
                                  <span id='not1outflowHiText' class='sugOutflowLabel'>Outflow fraction per cell.</span></label>
                                </div>
                                <div id='not1outflowLoDiv' class='grid-sugarDetail-item outflowLo'>
                                  <label><input id='not1outflowLoInput' class='sugOutflowLoInput' type='text' onchange='av.sgr.outflowChange(this);'/>&nbsp;
                                    <span id='not1outflowLoText' class='sugOutflowLabel'>Outflow fraction per cell on low side.</span></label>
                                </div>
                                <div id='not1equalHiDiv' class='grid-sugarDetail-item equalHi'>
                                  <span id='not1equalHiValue'></span>
                                  <span id='not1equalHiText'> = equilibrium when no resource has been consumed</span>
                                </div>
                                <div id='not1equalLoDiv' class='grid-sugarDetail-item equalLo'>
                                  <span id='not1equalLoValue'></span>
                                  <span id='not1equalLoText'> = equilibrium if not consumed</span>
                                </div>
                              </div><span id='not1SectionEnd' class='endsugarDishSubsection'> </span>

                              <div id='not2subSection' class='sugarDishSubsection'>
                              </div><span id='not2SectionEnd' class='endsugarDishSubsection'> </span>
                              
                              <div id='not3subSection' class='sugarDishSubsection'>
                              </div><span id='not3SectionEnd' class='endsugarDishSubsection'> </span>
                              
                              <div id='not4subSection' class='sugarDishSubsection'>
                              </div><span id='not4SectionEnd' class='endsugarDishSubsection'> </span>
                              
                            </div><span id='notDetailsEnd' class='end_sugarDetailSection_grid_container'></span>
                          </details>
                          
                          <details id='tskSection' class='sugarAccordionSection'>
                            <summary class='sugarSummary'>
                            </summary>
                            <div id='tskDetails' class='sugarDetailSection'>

                              <div id='tsk1subSection' class='sugarDishSubsection'>
                              </div><span id='tsk1SectionEnd' class='endsugarDishSubsection'> </span>
                              
                              <div id='tsk2subSection' class='sugarDishSubsection'>
                              </div><span id='tsk2SectionEnd' class='endsugarDishSubsection'> </span>
                              
                              <div id='tsk3subSection' class='sugarDishSubsection'>
                              </div><span id='tsk3SectionEnd' class='endsugarDishSubsection'> </span>
                              
                              <div id='tsk4subSection' class='sugarDishSubsection'>
                              </div><span id='tsk4SectionEnd' class='endsugarDishSubsection'> </span>
                            </div><span id='tskDetailsEnd' class='end_sugarDetailSection_grid_container'></span>
                          </details>
                        </div><span id='sugarAccordionEnd'></span>
  `; // End of template_orig string

</script>
